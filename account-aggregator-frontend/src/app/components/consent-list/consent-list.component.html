<div class="consent-list-container">
  <div class="list-header">
    <h2>Consent Requests</h2>
    <button class="btn btn-primary" (click)="refresh()">
      ðŸ”„ Refresh
    </button>
  </div>

  <div class="filters">
    <div class="search-box">
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        (input)="onSearch()"
        placeholder="Search by name, mobile, or consent ID...">
    </div>

    <div class="filter-box">
      <select [(ngModel)]="filterStatus" (change)="onFilterChange()">
        <option value="ALL">All Status</option>
        <option value="PENDING">Pending</option>
        <option value="REQUESTED">Requested</option>
        <option value="ACTIVE">Active</option>
        <option value="APPROVED">Approved</option>
        <option value="REJECTED">Rejected</option>
        <option value="EXPIRED">Expired</option>
        <option value="REVOKED">Revoked</option>
      </select>
    </div>
  </div>

  <div class="loading" *ngIf="loading">
    <div class="spinner"></div>
    <p>Loading consents...</p>
  </div>

  <div class="consent-table" *ngIf="!loading">
    <table *ngIf="filteredConsents.length > 0">
      <thead>
        <tr>
          <th>Consent ID</th>
          <th>Customer Name</th>
          <th>Mobile</th>
          <th>Status</th>
          <th>Created At</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let consent of filteredConsents">
          <td class="consent-id">{{ consent.consent_request_id }}</td>
          <td>{{ consent.customer_details.customer_name }}</td>
          <td>{{ consent.customer_details.customer_mobile }}</td>
          <td>
            <span class="status-badge" [ngClass]="getStatusClass(consent.status)">
              {{ consent.status }}
            </span>
          </td>
          <td>{{ consent.created_at | date:'short' }}</td>
          <td>
            <button class="btn-small btn-info" (click)="viewDetails(consent.consent_request_id)">
              View Details
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="no-data" *ngIf="filteredConsents.length === 0">
      <p>No consents found</p>
    </div>
  </div>
</div>